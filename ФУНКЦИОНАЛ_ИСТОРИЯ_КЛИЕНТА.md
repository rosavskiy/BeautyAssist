# üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª "–ò—Å—Ç–æ—Ä–∏—è –∫–ª–∏–µ–Ω—Ç–∞"

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –≤–∏–∑–∏—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä—è–º–æ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ –º–∞—Å—Ç–µ—Ä–∞. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –µ–≥–æ –∑–∞–ø–∏—Å–µ–π.

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –í —Ä–∞–∑–¥–µ–ª–µ "–ö–ª–∏–µ–Ω—Ç—ã" –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–ø–µ—Ä—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
- –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∫—É—Ä—Å–æ—Ä –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ pointer
- –ö–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤–∏–∑–∏—Ç–æ–≤

### 2. –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏
**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ:**
- –ò–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤
- –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

**–°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π:**
- –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞
- –°—Ç–∞—Ç—É—Å (–ó–∞–≤–µ—Ä—à–µ–Ω–∞, –û—Ç–º–µ–Ω–µ–Ω–∞, –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞, –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞)
- –°—É–º–º–∞ –æ–ø–ª–∞—Ç—ã
- –ó–∞–ø–∏—Å–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º

### 3. –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
**–¶–≤–µ—Ç–Ω—ã–µ –±–µ–π–¥–∂–∏ —Å—Ç–∞—Ç—É—Å–æ–≤:**
- üü¢ –ó–∞–≤–µ—Ä—à–µ–Ω–∞ - –∑–µ–ª–µ–Ω—ã–π (#4CAF50)
- üî¥ –û—Ç–º–µ–Ω–µ–Ω–∞ - –∫—Ä–∞—Å–Ω—ã–π (#F44336)
- üîµ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ - —Å–∏–Ω–∏–π (#2196F3)
- ‚ö™ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ - —Å–µ—Ä—ã–π (#9E9E9E)

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—É–º–º–µ:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è payment_amount (–µ—Å–ª–∏ –æ–ø–ª–∞—á–µ–Ω–æ)
- –ï—Å–ª–∏ –Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ü–µ–Ω–∞ —É—Å–ª—É–≥–∏ (service_price)

## API

### `GET /api/master/client/history`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø–∏—Å–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `mid` - telegram_id –º–∞—Å—Ç–µ—Ä–∞
- `client_id` - ID –∫–ª–∏–µ–Ω—Ç–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "client": {
    "id": 1,
    "name": "–ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞",
    "phone": "+79001234567",
    "username": "anna_ivanova",
    "total_visits": 5,
    "total_spent": 7500
  },
  "appointments": [
    {
      "id": 15,
      "service_name": "–ú–∞–Ω–∏–∫—é—Ä",
      "start_time": "2025-12-01T14:00:00+03:00",
      "status": "confirmed",
      "is_completed": true,
      "payment_amount": 1500,
      "service_price": 1500
    },
    {
      "id": 10,
      "service_name": "–ü–µ–¥–∏–∫—é—Ä",
      "start_time": "2025-11-15T16:00:00+03:00",
      "status": "confirmed",
      "is_completed": true,
      "payment_amount": 2000,
      "service_price": 2000
    }
  ]
}
```

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –º–∞—Å—Ç–µ—Ä–∞:
1. –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª "–ö–ª–∏–µ–Ω—Ç—ã" —á–µ—Ä–µ–∑ –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ (‚öôÔ∏è)
2. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
3. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –≤–∏–∑–∏—Ç–æ–≤ —Å –¥–µ—Ç–∞–ª—è–º–∏
4. –ó–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –∫–Ω–æ–ø–∫–æ–π √ó –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–§–∞–π–ª—ã:**
- `bot/main.py` - API endpoint `/api/master/client/history`
- `webapp-master/master.html` - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ `#client-history-section`
- `webapp-master/master.js` - —Ñ—É–Ω–∫—Ü–∏—è `openClientHistory(clientId)`

**SQL –∑–∞–ø—Ä–æ—Å:**
```python
select(Appointment, Service)
  .join(Service, Appointment.service_id == Service.id)
  .where(Appointment.client_id == client_id)
  .order_by(Appointment.start_time.desc())
```

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–∞–Ω–Ω–æ–º—É –º–∞—Å—Ç–µ—Ä—É
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –º–∞—Å—Ç–µ—Ä –≤–∏–¥–∏—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º  
‚úÖ **–£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –æ–¥–∏–Ω –∫–ª–∏–∫ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏  
‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - –¥–∞—Ç—ã, —É—Å–ª—É–≥–∏, —Å—É–º–º—ã, —Å—Ç–∞—Ç—É—Å—ã  
‚úÖ **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - –Ω–æ–≤—ã–µ –≤–∏–∑–∏—Ç—ã —Å–≤–µ—Ä—Ö—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞  
‚úÖ **–í–∏–∑—É–∞–ª—å–Ω–∞—è —è—Å–Ω–æ—Å—Ç—å** - —Ü–≤–µ—Ç–Ω—ã–µ –±–µ–π–¥–∂–∏ —Å—Ç–∞—Ç—É—Å–æ–≤  

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏–ª–∏ –ø–µ—Ä–∏–æ–¥—É
- –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ PDF
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫ –∫ –∫–∞–∂–¥–æ–º—É –≤–∏–∑–∏—Ç—É
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–º —É—Å–ª—É–≥–∞–º –∫–ª–∏–µ–Ω—Ç–∞
- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∫–ª–∏–µ–Ω—Ç–∞
